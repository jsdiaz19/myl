<mat-card>
  <mat-card-content>
    <mat-card-title>Productos De Baja Rotacion</mat-card-title>
    <mat-card-subtitle>Se presentara las ventas detallada de productos en 3 periodos de tiempo</mat-card-subtitle>

    <div id="Filtering">
      Tienda:
      <select id="store" (change)="loading($event)">
        <option value=" "> </option>
        <ng-container *ngFor="let tiendas of Store">
          <option  value={{tiendas}} *ngIf="tiendas!='001       '">{{tiendas}}</option>
        </ng-container> 
      </select>
    </div>
    
    <div id="Marca">
      Marca:
      <select (change)="applyFilter($event)"> 
        <option value=" "> </option>
        <option value="EA7"> EA7 </option>
        <option value="LACO"> LACO </option>
        <option value="NEW"> NEW </option>
      </select> 
    </div>
    
    <button mat-raised-button color="primary" (click)="exportAsExcel()" id="Download" >Exportar a Excel</button>

    <table mat-table [dataSource]="Source" class="mat-elevation-z8" id="Table">

      <ng-container matColumnDef="PRODUCTO">
        <th mat-header-cell *matHeaderCellDef> Referencia </th>
        <td mat-cell *matCellDef="let element"> {{element[0]}} </td>
      </ng-container>

      <ng-container matColumnDef="MARCA">
        <th mat-header-cell *matHeaderCellDef> Marca </th>
        <td mat-cell *matCellDef="let element"> {{element[1]}} </td>
      </ng-container>

      <ng-container matColumnDef="HACE 2 MESES">
        <th mat-header-cell *matHeaderCellDef="let element"> HACE 2 MESES </th>
        <td mat-cell *matCellDef="let element"> {{element[7]}} </td>
      </ng-container>

      <ng-container matColumnDef="HACE 1 MES">
        <th mat-header-cell *matHeaderCellDef> HACE 1 MESES </th>
        <td mat-cell *matCellDef="let element"> {{element[5]}} </td>
      </ng-container>

      <ng-container matColumnDef="MES ACTUAL">
        <th mat-header-cell *matHeaderCellDef> MES ACTUAL </th>
        <td mat-cell *matCellDef="let element"> {{element[3]}} </td>
      </ng-container>

      <ng-container matColumnDef="ROTAR">
        <th mat-header-cell *matHeaderCellDef> ROTAR </th>
        <td mat-cell *matCellDef="let element" > 
          <ng-container *ngIf="element[7]==element[5] && element[7]==element[3]">
            BAJA ROTACION
          </ng-container>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="Header"></tr>
      <tr mat-row *matRowDef="let row; columns: Header;"></tr>

    </table>

    
  </mat-card-content>
</mat-card>