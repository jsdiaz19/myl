<mat-card>
    <mat-card-content>
      <mat-card-title>Rentabilidad por periodo</mat-card-title>
      
      <div id="form" class="card-container" >
        <ng-container >
          AÃ±o:
          <select [formControl]="year" (change)="applyFilter()">
            <option value=" "> None</option>
            <option value="{{CurrentYear}}"> {{CurrentYear}} </option>
            <option value="{{CurrentYear-1}}"> {{CurrentYear-1}}</option>
          </select> 
        </ng-container >    

        <ng-container >
            Mes:
            <select [formControl]="month" (change)="applyFilter()">
              <option value=" "> None</option>
              <option value="01"> Enero </option>
              <option value="02"> Febrero</option>
              <option value="03"> Marzo </option>
              <option value="04"> Abril</option>
              <option value="05"> Mayo</option>
              <option value="06"> Junio</option>
              <option value="07"> Julio</option>
              <option value="08"> Agosto</option>
              <option value="09"> Septiembre</option>
              <option value="10"> Octubre</option>
              <option value="11"> Noviembre</option>
              <option value="12"> Diciembre</option>
            </select> 
          </ng-container >

          <button mat-raised-button color="primary" id="button" (click)="exportAsExcel()">Exportar a excel</button>
      </div>

      <table mat-table [dataSource]="Source" class="mat-elevation-z8" id="abstract">

          <ng-container matColumnDef="CO">
            <th mat-header-cell *matHeaderCellDef> C0 </th>
            <td mat-cell *matCellDef="let element"> {{element[0]}} </td>
          </ng-container>

          <ng-container matColumnDef="FECHA">
            <th mat-header-cell *matHeaderCellDef> FECHA </th>
            <td mat-cell *matCellDef="let element"> {{element[1]}} </td>
          </ng-container>

          <ng-container matColumnDef="VENTA">
            <th mat-header-cell *matHeaderCellDef> VENTA </th>
            <td mat-cell *matCellDef="let element"> {{element[2]}} </td>
          </ng-container>
        
          <ng-container matColumnDef="DEVOLUCIONES">
            <th mat-header-cell *matHeaderCellDef> DEVOLUCIONES </th>
            <td mat-cell *matCellDef="let element"> {{element[3]}} </td>
          </ng-container>

          <ng-container matColumnDef="VENTA NETA">
            <th mat-header-cell *matHeaderCellDef> VENTA NETA </th>
            <td mat-cell *matCellDef="let element"> {{element[4]}} </td>
          </ng-container>

          <ng-container matColumnDef="COSTO">
            <th mat-header-cell *matHeaderCellDef> COSTO </th>
            <td mat-cell *matCellDef="let element"> {{element[5]}} </td>
          </ng-container>

          <ng-container matColumnDef="RENTABILIDAD">
            <th mat-header-cell *matHeaderCellDef> RENTABILIDAD </th>
            <td mat-cell *matCellDef="let element"> {{element[6]}} </td>
          </ng-container>

          <ng-container matColumnDef="%RENTABILIDAD">
            <th mat-header-cell *matHeaderCellDef> %RENTABILIDAD </th>
            <td mat-cell *matCellDef="let element"> {{ element[7] }} </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    </mat-card-content>
</mat-card>
